XHTML to ODT XML transformation
-------------------------------

These stylesheets convert namespaced XHTML to [ODT][].


The HTML must be well-formed and valid, so I recommand running it through [Tidy][] before sending it to the stylesheets.

Those stylesheets do not build a whole ODT file, they only convert the XHTML to the equivalent OpenDocument XML. The result can then be inserted in a template ODT file. The HTML may be included in an ODT document, the ODT will be left untouched.

This is based on the work on [docbook2odt][], by Roman Fordinal. Many thanks to him.

[ODT]: http://en.wikipedia.org/wiki/OpenDocument
[Tidy]: http://tidy.sourceforge.net/
[docbook2odt]: http://open.comsultia.com/docbook2odf/


Caveats
-------

**Styles** : the styles are not added to the document. After converting to ODT, you must go through the styles used in the document and add the needed styles. Templates for those styles are provided in the "styles" subdirectory. If a style has a "display-name" property, it must be added to styles.xml. Otherwise it must be added to the automatic-styles section of content.xml.

**Images** : images are not added, you must manually go trough the draw:image elements in the converted ODT text and use the xlink:href attribute to download or copy the image. While you're at it, you should update the image dimensions if the were not provided in the img tag.


Command-line script
-------------------

A command-line script to run the stylesheets is provided. It does import the styles and the images, so while it's written in Python it can also be used as a code example for these two steps in another language. A PHP-base implementation can be found in the [Dotclear ODT export plugin][].

The script depends on the following Python modules:

 * [uTidylib][]
 * [lxml][]
 * [PIL][]

To get information on the script's options, run it with `--help`:

    ./xhtml2odt.py --help

The script can be installed on the system with the `make install` command.

[Dotclear ODT export plugin]: http://lab.dotclear.org/wiki/plugin/odt
[uTidylib]: http://pypi.python.org/pypi/uTidylib
[lxml]: http://pypi.python.org/pypi/lxml
[PIL]: http://pypi.python.org/pypi/PIL


Tests
-----

The unit tests are python-based, you need to install the "nose" python module
availble from PyPI (or your distribution).

Then, just run `nosetests tests`.


References
----------

 * [ODT export for Dotclear](http://lab.dotclear.org/wiki/plugin/odt)
 * [ODT export for Trac](http://trac-hacks.org/wiki/OdtExportPlugin)
 * [ODT export for Dokuwiki](http://www.dokuwiki.org/plugin:odt) (not using this project, but similar and by the same author)


License
-------

Copyright (C) 2009-2010 [Aurelien Bompard][].

License is GPL v2 or later.

Based on the work on [docbook2odt][], by Roman Fordinal.

[Aurelien Bompard]: http://aurelien.bompard.org/
[docbook2odt]: http://open.comsultia.com/docbook2odf/

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
